local Players = game:GetService('Players')
local VirtualInputManager = game:GetService('VirtualInputManager')
local localPlayer = Players.LocalPlayer

-- âœ… List of your alts (15 slots used here)
local altList = {
    'TheGreatestTurtle12',
    'TheGreatestTurtle13',
    'TheGreatestTurtle14',
    'TheGreatestTurtle15',
    'TheGreatestTurtle16',
    'TheGreatestTurtle18',
    'TheGreatestTurtle19',
    'TheGreatestTurtle20',
    'TheGreatestTurtle21',
    'TheGreatestTurtle22',
    'TheGreatestTurtle23', 
    'dribblecurses',
    'oooeeewq',
    'Synxownsyou',
    'ssprinklez0a',
}

-- Exception list
local exceptionList = {
    ''
}

-- Required list
local requiredList = {
    'psykoticpsykotic',
}

-- Teleport positions
local teleportPositions = {
    Vector3.new(-16, 4, -10),
    Vector3.new(-8, 4, -10),
    Vector3.new(0, 4, -10),
    Vector3.new(8, 4, -10),
    Vector3.new(16, 4, -10),
    Vector3.new(-16, 4, 0),
    Vector3.new(-8, 4, 0),
    Vector3.new(0, 4, 0),
    Vector3.new(8, 4, 0),
    Vector3.new(16, 4, 0),
    Vector3.new(-16, 4, 10),
    Vector3.new(-8, 4, 10),
    Vector3.new(0, 4, 10),
    Vector3.new(8, 4, 10),
    Vector3.new(16, 4, 10),
}

-- Configuration
getgenv().teleportInterval = 17
getgenv().preSpamDelay = 2
getgenv().spamTime = 12
getgenv().spamKey = Enum.KeyCode.Three
local characterHeight = 7

-- Utilities
local function nameEquals(a, b)
    if not a or not b then return false end
    return a:lower() == b:lower()
end

local function isInList(name, list)
    if not name or not list then return false end
    for _, v in pairs(list) do
        if v ~= '' and nameEquals(name, v) then
            return true
        end
    end
    return false
end

local function getAltIndex(name)
    for i, v in pairs(altList) do
        if v ~= '' and nameEquals(name, v) then
            return i
        end
    end
    return nil
end

-- Returns a list of missing accounts
local function getMissingAccounts(list)
    local missing = {}
    if not list or #list == 0 then return missing end
    for _, name in pairs(list) do
        if name ~= '' and Players:FindFirstChild(name) == nil then
            table.insert(missing, name)
        end
    end
    return missing
end

-- Exception check
if isInList(localPlayer.Name, exceptionList) then
    warn('Local player is on the exception list. Script will not run for this account.')
    return
end

-- Local player must be in altList
if not isInList(localPlayer.Name, altList) then
    warn('Local player is not in altList. Script will not run.')
    return
end

-- Main runner
print('Teleport + Key spam script initialized. Waiting for all required accounts to be present...')

task.spawn(function()
    while true do
        -- Check missing accounts
        local missingAlt = getMissingAccounts(altList)
        local missingReq = getMissingAccounts(requiredList)

        if #missingAlt > 0 or #missingReq > 0 then
            warn('The following accounts are missing:')
            if #missingAlt > 0 then
                warn('Missing from altList: ' .. table.concat(missingAlt, ', '))
            end
            if #missingReq > 0 then
                warn('Missing from requiredList: ' .. table.concat(missingReq, ', '))
            end
            task.wait(5)
            continue
        end

        -- All accounts present, run teleport + spam
        local startTime = os.clock()
        local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
        local humanoid = character:WaitForChild('Humanoid')
        local humanoidRootPart = character:WaitForChild('HumanoidRootPart')

        if humanoidRootPart and humanoid then
            local altIndex = getAltIndex(localPlayer.Name)
            local teleportPosition = teleportPositions[altIndex] or Vector3.new(-10, 4, -5)

            if not teleportPosition then
                warn('No teleport position found for this alt index. Skipping this cycle.')
            else
                local teleporting = true
                task.spawn(function()
                    while teleporting and humanoid.Health > 0 do
                        humanoidRootPart.CFrame = CFrame.new(teleportPosition + Vector3.new(0, characterHeight, 0))
                        task.wait()
                    end
                end)

                -- Pre-spam delay
                local preStart = os.clock()
                while os.clock() - preStart < getgenv().preSpamDelay do
                    if #getMissingAccounts(altList) > 0 or #getMissingAccounts(requiredList) > 0 then
                        warn('Required accounts left during pre-spam delay. Stopping this run.')
                        teleporting = false
                        break
                    end
                    task.wait(0.1)
                end

                -- Spam key
                if teleporting then
                    local spamStart = os.clock()
                    while os.clock() - spamStart < getgenv().spamTime do
                        if humanoid.Health <= 0 then break end
                        if #getMissingAccounts(altList) > 0 or #getMissingAccounts(requiredList) > 0 then
                            warn('Required accounts left during spam. Aborting spam early.')
                            break
                        end
                        VirtualInputManager:SendKeyEvent(true, getgenv().spamKey, false, game)
                        task.wait(0.05)
                        VirtualInputManager:SendKeyEvent(false, getgenv().spamKey, false, game)
                        task.wait(0.05)
                    end
                end

                teleporting = false
            end

            -- Wait remaining time
            local elapsed = os.clock() - startTime
            local remainingTime = getgenv().teleportInterval - elapsed
            local waited = 0
            while remainingTime > 0 and waited < remainingTime do
                if #getMissingAccounts(altList) > 0 or #getMissingAccounts(requiredList) > 0 then
                    warn('Required accounts left during wait. Pausing until all are back.')
                    break
                end
                task.wait(0.5)
                waited = waited + 0.5
            end
        else
            task.wait(1)
        end
    end
end)

print('Script running (subject to presence of all accounts in altList & requiredList).')
